# Resultaten

```{r include=FALSE}
source("./code/not_functions/libraries.R")
source("./code/functions/f.read_excel_allsheets.R")
source("./code/functions/f.dominant.species.R")
source("./code/functions/f.transformation.R")
source("./code/functions/f.dispersie.R")
source("./code/functions/f.pairwise.adonis.R")
source("./code/functions/f.plot.habitat.spatial.R")
source("./code/functions/f.map.R")
source("./code/functions/f.select.envfit.R")
theme_set(theme_elsevier(8))
```

## Abiotiek

Een overzicht van de tijdreeksen van relevante meetstations voor het studiegebied is gegeven in Figuren \@ref(fig:tijdreeksen) en \@ref(fig:tijdreeksenstudieperiode). Een overzicht van de locaties is beschikbaar via deze [link](http://rpubs.com/spbruneel-INBO/maps_bal_schip).

```{r}
files<-list.files(path="./data/abiotiek/extern/metingen/",pattern = ".csv")
for (i in 1:length(files)){
  path<-paste0("./data/abiotiek/extern/metingen/",files[i])
  file_name<-gsub(".csv","",files[i])
  temp<-read.csv(path,sep=';',skip=7)[,1:2]
  colnames(temp)<-c("date","value")
  temp$loc<-str_split_1(file_name,"_")[1]
  temp$regio<-str_split_1(file_name,"_")[2]
  temp$var<-str_split_1(file_name,"_")[3]
  temp$value<-as.numeric(sub(",", ".", temp$value, fixed = TRUE))
  if (i==1){data=temp} else {data=rbind(data,temp)}
}

data$date=substr(gsub("T", " ", as.character(data$date)),1,19)
data$date_brussels = as.POSIXct(data$date,format='%Y-%m-%d %H:%M:%S',tz="Europe/Brussels")
data$date_utc = data$date_brussels; attr(data$date_utc, "tzone") <- "GMT"
data$loc=factor(data$loc, levels=c("Damme","Maldegem DVW","Adegem-Balgerhoeke Opwaarts DVW","Zomergem","Merendree Afwaarts DVW","Merendree Opwaarts DVW"))
data$var=factor(data$var, levels=c("Waterpeil","Afvoer","Watertemperatuur"))

remove(files,path,file_name,temp)
```

```{r tijdreeksen, fig.height=10, fig.width=10, fig.cap="Overzicht van metingen van waterpeil (m), afvoer (m³/s) en temperatuur (°C) voor relevante meetstations doorheen de tijd. De stations staan geordend van stroomafwaarts naar stroomopwaarts. De meetstations van Damme en Maldegem liggen in het pand Zeebrugge-Balgerhoeke. De meetstations van Adegem-Balgerhoeke, Zomergem en Merendree Afwaarts liggen in het pand Balgerhoeke-Schipdonk. Het meetstation Merendree Opwaarts ligt stroomopwaarts van Schipdonk. Rode lijnen begrenzen de studieperiode (22 maart 2023 - 25 mei 2023). De groene lijn geeft de gesmoothe trend aan (span=1)."}
ggplot(data, aes(x = date_utc, y = value)) + 
  geom_line() +
  xlab("Datum") + ylab("Waarde") +
  facet_wrap(~ var + loc,scales="free_y") + 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
  geom_vline(xintercept = as.POSIXct("2023-03-22"),color = "red", size = 1) +
  geom_vline(xintercept = as.POSIXct("2023-05-25"),color = "red", size = 1) +
  scale_x_datetime(date_labels = "%d-%m", date_breaks = "15 days") + geom_smooth(color="green")
```

```{r tijdreeksenstudieperiode, fig.height=10, fig.width=10, fig.cap="Overzicht van metingen van waterpeil (m), afvoer (m³/s) en temperatuur (°C) voor relevante meetstations doorheen de tijd voor de studieperiode (22 maart 2023 - 25 mei 2023) De stations staan geordend van stroomafwaarts naar stroomopwaarts. De meetstations van Damme en Maldegem liggen in het pand Zeebrugge-Balgerhoeke. De meetstations van Adegem-Balgerhoeke, Zomergem en Merendree Afwaarts liggen in het pand Balgerhoeke-Schipdonk. Het meetstation Merendree Opwaarts ligt stroomopwaarts van Schipdonk. De groene lijn geeft de gesmoothe trend aan (span=1)."}
ggplot(data %>% dplyr::filter(date_utc>as.POSIXct("2023-03-22") & date_utc<as.POSIXct("2023-05-25")), aes(x = date_utc, y = value)) + 
  geom_line() +
  xlab("Datum") + ylab("Waarde") +
  facet_wrap(~ var + loc,scales="free_y") + 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
  scale_x_datetime(date_labels = "%d-%m", date_breaks = "15 days") + geom_smooth(color="green")
```

Stroomafwaarts van Balgerhoeke t.h.v. het meetpunt te Maldegem, varieerde het waterpeil tijdens de studieperiode (22 maart 2023 - 25 mei 2023) tussen ongeveer 1.3 m en 2.8 m terwijl stroomopwaarts, t.h.v. het meetpunt te Balgerhoeke, het waterpeil slechts varieerde tussen de 4.9 en 5.1 meter. Het verval t.h.v. de stuw van Balgerhoeke bedroeg gemiddeld 3.30 meter en varieerde tussen 2.22 en 3.71 meter. Stroomopwaarts van Schipdonk varieerde het waterpeil tussen ongeveer 5.55 meter en 6.0 meter (meetpunt Merendree stroomopwaarts) terwijl stroomafwaarts het waterpeil slecht varieerde tussen de 4.95 en 5.15 meter (meetpunt Merendree stroomafwaarts). Het verval t.h.v. de stuw van Schipdonk bedroeg gemiddeld 0.70 meter en varieerde tussen 0.49 en 0.96 meter. Tussen Balgerhoeke en Schipdonk varieerde het waterpeil tussen de 4.95 en 5.10 meter (meetpunt Zomergem).

De afvoer stroomafwaarts van Balgerhoeke (meetpunt Damme) wordt gekenmerkt door plotse pieken van ongeveer 20 m³ en een gemiddelde afvoer van 2.03 m³/s (Tabel \@ref(tab:debietoverzicht)). Wanneer de piekdebieten niet in rekening worden gebracht bedraagt de gemiddelde afvoer -0.006 m³/s. De stroomopwaartse debieten (i.e. de negatieve waarden) bedragen 49 % van de data en zijn in absolute waarde niet meer dan 2.96 m³/s. De afvoer tussen Balgerhoeke en Schipdonk (meetpunt Zomergem) bedraagt zelden meer dan 2.5 m³/s, is gemiddeld 0.28 m³ en varieert tussen -1.51 m³/s en 3.01 m³/s. De stroomopwaartse debieten bedragen 26 % van de data en zijn in absolute waarde niet meer dan 1.51 m³/s. Ondanks het feit dat dit relatief lage debieten zijn, zijn deze wellicht wel voldoende voor verschillende technische vispassages. Een standaard bekkenvispassage en vertical slot vispassage vereisen bijvoorbeeld 0.15 m³/s. Een De Wit-vispassage, een variant op de vertical slot vispassage, is uitermate geschikt voor regio's waar weinig water voorhanden is en waar te weinig afvoer is voor een nevenbeek [@coenen2013].

```{r include=FALSE}
data_wide <- spread(data %>% dplyr::filter(var=="Waterpeil" & date_utc>as.POSIXct("2023-03-22") & date_utc<as.POSIXct("2023-05-25")) %>% dplyr::select(date_utc,value,loc), loc, value)
min(data_wide$`Maldegem DVW`,na.rm=TRUE)
max(data_wide$`Maldegem DVW`,na.rm=TRUE)
data_wide$verval_Balgerhoeke=data_wide$`Maldegem DVW`-data_wide$`Adegem-Balgerhoeke Opwaarts DVW`
mean(data_wide$verval_Balgerhoeke,na.rm=TRUE)
min(data_wide$verval_Balgerhoeke,na.rm=TRUE)
max(data_wide$verval_Balgerhoeke,na.rm=TRUE)
data_wide$verval_Schipdonk=data_wide$`Merendree Afwaarts DVW`-data_wide$`Merendree Opwaarts DVW`
mean(data_wide$verval_Schipdonk,na.rm=TRUE)
min(data_wide$verval_Schipdonk,na.rm=TRUE)
max(data_wide$verval_Schipdonk,na.rm=TRUE)

data_wide <- spread(data %>% dplyr::filter(var=="Afvoer" & date_utc>as.POSIXct("2023-03-22") & date_utc<as.POSIXct("2023-05-25")) %>% dplyr::select(date_utc,value,loc), loc, value)

length(which(data_wide$Damme<0))/nrow(data_wide)
length(which(data_wide$Zomergem<0))/nrow(data_wide)

data_wide$Damme_zonder_pieken<-data_wide$Damme
data_wide$Damme_zonder_pieken[which(abs(data_wide$Damme)>5)]=NA

plot(data_wide$date_utc,data_wide$Damme_zonder_pieken)
length(which(data_wide$Damme_zonder_pieken<0))/nrow(data_wide)

min(data_wide$Damme,na.rm=TRUE)
max(data_wide$Damme,na.rm=TRUE)
mean(data_wide$Damme,na.rm=TRUE)
sd(data_wide$Damme,na.rm=TRUE)

min(data_wide$Damme_zonder_pieken,na.rm=TRUE)
max(data_wide$Damme_zonder_pieken,na.rm=TRUE)
mean(data_wide$Damme_zonder_pieken,na.rm=TRUE)
sd(data_wide$Damme_zonder_pieken,na.rm=TRUE)

min(data_wide$Zomergem,na.rm=TRUE)
max(data_wide$Zomergem,na.rm=TRUE)
mean(data_wide$Zomergem,na.rm=TRUE)
sd(data_wide$Zomergem,na.rm=TRUE)
```

```{r eval=FALSE}
coordinaten<-read.csv("./data/abiotiek/extern/coordinaten/coordinaten_waterinfo.csv",sep=";")
map<-f.map(coordinaten,"x.coordinaat","y.coordinaat",crs="+init=epsg:31370","Stationsnaam","Data.eigenaar")
shape=sf::st_read("./data/vis/extern/ruw/knelpunten_databank_vmm/knelpunten.shp")
st_crs(shape)
shape1 <- shape %>% st_transform(4326)
bounds <- map %>% 
    st_bbox() %>% 
    as.character()
mapa <- leaflet(shape1) %>% addTiles() %>% addMarkers() %>%       addCircleMarkers(data=map,radius=8,color='red',fillOpacity=0.7,weight=1) %>% fitBounds(bounds[1], bounds[2], bounds[3], bounds[4]) %>% addProviderTiles(providers$Stadia.StamenTerrain)
mapa
```

```{r debietoverzicht}
data %>% 
  group_by(loc) %>% 
  dplyr::filter(date_utc>as.POSIXct("2023-03-22") & date_utc<as.POSIXct("2023-05-25") & var == "Afvoer") %>%
  summarise('med. debiet (m³/s)' = round(median(value,na.rm=TRUE),digits=2),
            'gem. debiet (m³/s)' = round(mean(value,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 0.1 m³/s' = round(sum(value<0.1,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 0.25 m³/s' = round(sum(value<0.25,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 0.5 m³/s' = round(sum(value<0.5,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 1 m³/s' = round(sum(value<1,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 2 m³/s' = round(sum(value<2,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 3 m³/s' = round(sum(value<3,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 4 m³/s' = round(sum(value<4,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 5 m³/s' = round(sum(value<5,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 10 m³/s' = round(sum(value<10,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 20 m³/s' = round(sum(value<20,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2),
            'Aandeel studieperiode < 30 m³/s' = round(sum(value<30,na.rm=TRUE)/sum(value<1000,na.rm=TRUE),digits=2)) %>%
  pivot_summary(loc) %>%
  rename(Debiet = column) %>% kable(caption="Gemiddeld debiet, mediaan debiet en aandeel studieperiode (22 maart 2023 - 25 mei 2023) dat debiet onder een opgegeven waarde lag voor stations te Damme (pand Zeebrugge-Balgerhoeke) en Zomergem (pand Balgerhoeke-Schipdonk).")
```

## Vissen

```{r}
vis<-f.read_excel_allsheets("./data/vis/extern/verwerkt_in_excel/data balgerhoeke 2023.xlsx")
afkortingen<-vis[[1]]
vis[[1]]<-NULL
vis<-rbindlist(vis)
colnames(vis)<-make.names(colnames(vis))
colnames(vis)[which(colnames(vis)=="Taxon.naam")]="soort"

vis$Taxon.aantal[which(is.na(vis$Taxon.aantal)==TRUE)]=1
vis$soort<-tolower(vis$soort)
vis$Methode<-tolower(vis$Methode)
vis$gemerkt<-tolower(vis$gemerkt)
vis$gemerkt[which(is.na(vis$gemerkt)==TRUE)]="n"
vis<-vis[-which(is.na(vis$soort)==TRUE | vis$soort %in% c("chinese wolhandkrab","rode amerikaanse rivierkreeft")),]

vis$Meetplaatscode[which(vis$Meetplaatscode=="balgo")]="balgoo"
vis$Meetplaatscode[which(vis$Meetplaatscode=="bali")]="balli"
vis$Meetplaatscode[which(vis$Meetplaatscode=="merre")]="merro"
vis$Meetplaatscode[which(vis$Meetplaatscode=="merfif")]="mersif"
vis$plaats<-substr(vis$Meetplaatscode,1,3)
vis$plaats[which(vis$Meetplaatscode=="mersif")]="Schipdonk sifon"
vis$plaats[which(vis$Meetplaatscode %in% c("merlo","merro"))]="Schipdonk sluis"
vis$plaats[which(vis$plaats=="bal")]="Balgerhoeke"
vis$maand<-format(vis$Datum,"%m-%Y")

vis<-vis[-which(vis$Meetplaatscode %in% c("balrwzi","balede")),]
vis<-vis[-which(vis$Meetplaatscode=="balsgo" & vis$Methode=="palinggoot"),] #14/4 field sheets missing
vis<-vis[-which(vis$Meetplaatscode=="balgoo" & vis$Methode=="substraat"),] #field sheets 24/3 missing; not found in field sheets of 7/4

vis<-left_join(vis,afkortingen[,c(1,3)],by="Meetplaatscode")

vis$Meetplaatscode[which(vis$Meetplaatscode %in% c("ballo","balro","balhok","baltot","balsch"))]="balfuik"

max.lengte<-read.csv("./data/vis/extern/verwerkt_in_excel/maximale_vislengtes.csv",sep=";")
colnames(max.lengte)<-make.names(colnames(max.lengte))

vis <- vis %>%
  left_join(max.lengte,  by  = "soort") %>%
  mutate(Taxon.lengte = case_when(is.na(max.lengte) ~ Taxon.lengte,
                                  max.lengte >= Taxon.lengte ~ Taxon.lengte,
                                  TRUE ~ NA)) %>%
  dplyr::select(-last_col())

vis <- vis %>% 
  group_by(plaats,maand,soort) %>%
  mutate(mediaan.lengte=median(Taxon.lengte,na.rm=TRUE))
vis$Taxon.lengte.imputatie<-vis$Taxon.lengte
vis$Taxon.lengte.imputatie[which(is.na(vis$Taxon.lengte)==TRUE)]<-vis$mediaan.lengte[which(is.na(vis$Taxon.lengte)==TRUE)]

vis.soorten<-as.data.frame(unique(vis$soort))
colnames(vis.soorten)="soort"
vis.soorten<-t(vis.soorten)
colnames(vis.soorten)<-vis.soorten

vis.fuik<-vis[which(vis$Methode=="schietfuik" | vis$Methode=="hokfuik"),]
vis.fuik$reproductie<-"nee"
vis.fuik$reproductie[which(vis.fuik$Meting.commentaar %in% c("eieren","eitjes","eitjes?","eitjs"))]="ja"
vis.fuik$reproductie[which(vis.fuik$Meting.commentaar %in% c("hom","h","hom, paaiuitslag","paaiuitslag/hom","paaiuitslag + hom"))]="ja"
vis.fuik$aantal.fuiken=NA
vis.fuik$aantal.fuiken[which(vis.fuik$plaats=="Balgerhoeke")]=2
vis.fuik$aantal.fuiken[which(vis.fuik$plaats=="Schipdonk sluis")]=2
vis.fuik$aantal.fuiken[which(vis.fuik$plaats=="Schipdonk sifon")]=1
dagen.tussen.staalnames=unique(vis.fuik[c("Meetplaatscode","Datum")])
dagen.tussen.staalnames <- dagen.tussen.staalnames %>%
  dplyr::arrange(Meetplaatscode,Datum) %>%
  group_by(Meetplaatscode) %>%
  dplyr::mutate(Datum.lag=dplyr::lag(Datum),dagen=Datum-Datum.lag) %>%
  dplyr::mutate(dagen=case_when(is.na(dagen)~mean(dagen,na.rm=TRUE),
                                TRUE~dagen)) %>%
  dplyr::select(-Datum.lag)
vis.fuik<-left_join(vis.fuik,dagen.tussen.staalnames,by=c("Meetplaatscode","Datum"))
vis.fuik$CPUE<-vis.fuik$Taxon.aantal/(vis.fuik$aantal.fuiken*as.numeric(vis.fuik$dagen))

vis.goot<-vis[which(vis$Methode=="palinggoot"),]

vis.substraat<-vis[which(vis$Methode=="substraat"),]
vis.substraat<-vis.substraat[-which(vis.substraat$soort!="paling"),]
vis.substraat$Taxon.lengte[which(vis.substraat$Taxon.lengte<30)]=NA
```

### Data-overzicht

De fuiken, hokfuik en schietfuiken te Balgerhoeke werden om logistische redenen samengenomen en kregen daarom één meetplaatscode (balfuik) toegekend. In totaal werden 4575 vissen gevangen met de fuiken te Balgerhoeke (Tabel \@ref(tab:totalentechniek)). In de palinggoot werd ongeveer 5 % gevangen (59 elvers) van wat er gevangen werd met de substraten in Balgerhoeke (1270 elvers) (Tabel \@ref(tab:totalenlocatie)). De substraten t.h.v. de oevers te Balgerhoeke vingen in totaal ongeveer 5 tot 10 keer meer dan de substraten t.h.v. de oude sluis en palinggoot respectievelijk. In totaal werden 8524 vissen gevangen met de fuiken te Schipdonk (Tabel \@ref(tab:totalentechniek)). In totaal werden t.h.v. de sifon meer vissen gevangen dan t.h.v. de sluis van Schipdonk ondanks dat t.h.v de sluis twee fuiken werden gebruikt en t.h.v. de sifon slechts één.

```{r totalentechniek}
options(knitr.kable.NA = 0)
vis %>% group_by(Meetplaatscode,Methode) %>% summarize(aantal=sum(Taxon.aantal)) %>% pivot_wider(names_from = c(Methode), values_from = c(aantal)) %>% kable(caption="Overzicht vangsten per meetplaats en datum. balfuik: hokfuik en schietfuiken linkeroever en rechteroever Balgerhoeke, balgoo: Palinggoot Balgerhoeke, balsgo: Substraat t.h.v. palinggoot Balgerhoeke, balli: Substraat linkeroever Balgerhoeke, balre: Substraat rechteroever Balgerhoeke, balslu: Substraat oude sluis Balgerhoeke, mersif: Schietfuik sifon Merendree, merlo: Schietfuik linkeroever sluis Merendree, merro: Schietfuik rechteroever sluis Merendree. De substraten te Schipdonk staan hier niet weergegeven omdat er nooit paling in werd gevonden.")
```

```{r totalenlocatie}
options(knitr.kable.NA = 0)
vis %>% group_by(Meetplaatscode,Datum) %>% summarize(aantal=sum(Taxon.aantal)) %>% pivot_wider(names_from = c(Meetplaatscode), values_from = c(aantal)) %>% kable(caption="Overzicht vangsten per meetplaats en datum. balfuik: hokfuik en schietfuiken linkeroever en rechteroever Balgerhoeke, balgoo: Palinggoot Balgerhoeke, balsgo: Substraat t.h.v. palinggoot Balgerhoeke, balli: Substraat linkeroever Balgerhoeke, balre: Substraat rechteroever Balgerhoeke, balslu: Substraat oude sluis Balgerhoeke, mersif: Schietfuik sifon Merendree, merlo: Schietfuik linkeroever sluis Merendree, merro: Schietfuik rechteroever sluis Merendree. De substraten te Schipdonk staan hier niet weergegeven omdat er nooit paling in werd gevonden.")
```

### Fuiken

```{r}
vis.breed <- vis.fuik %>% 
  dplyr::select(plaats,Methode,Meetplaatscode,maand,Datum,soort,CPUE) %>% 
  group_by(plaats,Methode,Meetplaatscode,maand,Datum,soort) %>% 
  summarise(CPUE=sum(CPUE,na.rm=TRUE)) %>% 
  arrange(soort) %>%
  pivot_wider(names_from = soort, values_from = CPUE) %>%
  group_by(plaats,Methode,Meetplaatscode,Datum,maand) %>%
  summarise_if(is.numeric, sum, na.rm = TRUE)
```

#### Gemeenschapsstructuur

Alle geobserveerde soorten (19 in totaal) die werden gevangen in Balgerhoeke werden ook gevangen in Schipdonk (met uitzondering van één driedoornige stekelbaars in Balgerhoeke) (Tabellen \@ref(tab:balgerhoekefuikdag), \@ref(tab:balgerhoekefuik), \@ref(tab:schipdonksifonfuikdag), \@ref(tab:schipdonksifonfuik), \@ref(tab:schipdonksluisfuikdag), \@ref(tab:schipdonksluisfuik), \@ref(tab:vangstfuikdag) en \@ref(tab:vangstfuik)). In Balgerhoeke, Schipdonk sifon en Schipdonk sluizen bedroeg de Shannon diversiteit gemiddeld 1.19, 1.43 en 1.45 respectievelijk. Er waren sterke verschillen in de aantallen van sommige soorten. In Balgerhoeke werd in totaal veel meer bittervoorn en snoek en veel minder kolblei en zonnebaars gevangen (Figuren \@ref(fig:visbarplotabsoluutfuikdag) en \@ref(fig:visbarplotabsoluutfuik)). In zowel Balgerhoeke als Schipdonk werden relatief grote aantallen baars, blankvoorn en pos aangetroffen in het begin van de paaiperiode. Naar het einde van de paaiperiode van deze soorten, daalden ook hun aantallen stroomafwaarts van de complexen. Dit wijst erop dat voor deze soorten, die de vangsten domineren, de complexen belangrijke barrières zijn. Aantallen en soort werden gebruikt om de gemeenschapsstructuur van de drie sites (Balgerhoeke, Schipdonk sifon en Schipdonk sluis) en drie maanden te vergelijken (PERMANOVA, Bray-curtis afstand, vierde-wortel van de fuikvangsten per fuikdag en per soort). Alle drie sites bleken significant verschillend met de grootste verschillen tussen Balgerhoeke enerzijds en Schipdonk anderzijds (Figuur \@ref(fig:vis-pcoa)). Er werd een significant verschil genoteerd tussen de maanden mei enerzijds en maart en april anderzijds. De variabiliteit in gemeenschapsstructuur was voornamelijk het gevolg van verschillen in voorkomen van pos (vnl. Balgerhoeke), baars (vnl. Balgerhoeke), brasem (vnl. Schipdonk sifon), blankvoorn (vnl. Schipdonk sifon) en kolblei (vnl. Schipdonk sifon).

```{r}
shannon<-vis.fuik %>% group_by(Meetplaatscode,Datum,soort,maand,plaats) %>% summarise(CPUE=sum(CPUE)) %>% ungroup() %>% dplyr::summarize(shannon = vegan::diversity(CPUE), .by = c(Meetplaatscode,Datum,maand,plaats)) %>% group_by(plaats) %>% summarise(shannon=mean(shannon))
```

```{r balgerhoekefuikdag, include=TRUE}
options(knitr.kable.NA = 0)
vis.fuik %>% dplyr::filter(plaats %in% c("Balgerhoeke")) %>% group_by(Meetplaatscode,Datum,soort,maand) %>% summarize(CPUE=sum(CPUE)) %>% ungroup() %>% group_by(maand,soort) %>% summarize(CPUE=round(mean(CPUE),digits=2)) %>% pivot_wider(names_from = c(maand), values_from = c(CPUE)) %>% kable(caption="Soortensamenstelling en overzicht van de gemiddelde aantallen per fuikdag, per vissoort en per maand in Balgerhoeke (sampling effort in rekening gebracht)") 
```

```{r balgerhoekefuik, include=TRUE}
options(knitr.kable.NA = 0)
vis.fuik %>% dplyr::filter(plaats %in% c("Balgerhoeke")) %>% group_by(maand,soort) %>% summarize(aantal=sum(Taxon.aantal)) %>% pivot_wider(names_from = c(maand), values_from = c(aantal)) %>% kable(caption="Soortensamenstelling en overzicht van de totale fuikvangsten per vissoort en per maand in Balgerhoeke (sampling effort niet in rekening gebracht)")
```

```{r schipdonksifonfuikdag, include=TRUE}
options(knitr.kable.NA = 0)
vis.fuik %>% dplyr::filter(plaats %in% c("Schipdonk sifon")) %>% group_by(Meetplaatscode,Datum,soort,maand) %>% summarize(CPUE=sum(CPUE)) %>% ungroup() %>% group_by(maand,soort) %>% summarize(CPUE=round(mean(CPUE),digits=2)) %>% pivot_wider(names_from = c(maand), values_from = c(CPUE)) %>% kable(caption="Soortensamenstelling en overzicht van de gemiddelde aantallen per fuikdag, per vissoort en per maand in Schipdonk sifon (sampling effort in rekening gebracht)")
```

```{r schipdonksifonfuik, include=TRUE}
options(knitr.kable.NA = 0)
vis.fuik %>% dplyr::filter(plaats %in% c("Schipdonk sifon")) %>% group_by(maand,soort) %>% summarize(aantal=sum(Taxon.aantal)) %>% pivot_wider(names_from = c(maand), values_from = c(aantal)) %>% kable(caption="Soortensamenstelling en overzicht van de totale fuikvangsten per vissoort en per maand in Schipdonk sifon (sampling effort niet in rekening gebracht)")
```

```{r schipdonksluisfuikdag, include=TRUE}
options(knitr.kable.NA = 0)
vis.fuik %>% dplyr::filter(plaats %in% c("Schipdonk sluis")) %>% group_by(Meetplaatscode,Datum,soort,maand) %>% summarize(CPUE=sum(CPUE)) %>% ungroup() %>% group_by(maand,soort) %>% summarize(CPUE=round(mean(CPUE),digits=2)) %>% pivot_wider(names_from = c(maand), values_from = c(CPUE)) %>% kable(caption="Soortensamenstelling en overzicht van de gemiddelde aantallen per fuikdag, per vissoort en per maand aan de Schipdonk sluizen (sampling effort in rekening gebracht)")
```

```{r schipdonksluisfuik, include=TRUE}
options(knitr.kable.NA = 0)
vis.fuik %>% dplyr::filter(plaats %in% c("Schipdonk sluis")) %>% group_by(maand,soort) %>% summarize(aantal=sum(Taxon.aantal)) %>% pivot_wider(names_from = c(maand), values_from = c(aantal)) %>% kable(caption="Soortensamenstelling en overzicht van de totale fuikvangsten per vissoort en per maand in Schipdonk sluis (sampling effort niet in rekening gebracht)")
```

```{r vangstfuikdag, include=TRUE}
options(knitr.kable.NA = 0)
vis.fuik %>% group_by(Meetplaatscode,Datum,soort,maand,plaats) %>% summarize(CPUE=sum(CPUE)) %>% ungroup() %>% group_by(plaats,soort) %>% summarize(CPUE=round(mean(CPUE),digits=2)) %>% pivot_wider(names_from = c(plaats), values_from = c(CPUE)) %>% kable(caption="Soortensamenstelling en overzicht van de gemiddelde vangsten per fuikdag, per vissoort voor de hele periode voor Schipdonk en Balgerhoeke (sampling effort in rekening gebracht)")
```

```{r vangstfuik, include=TRUE}
options(knitr.kable.NA = 0)
vis.fuik %>% group_by(plaats,soort) %>% summarize(aantal=sum(Taxon.aantal)) %>% pivot_wider(names_from = c(plaats), values_from = c(aantal)) %>% kable(caption="Soortensamenstelling en overzicht van de totale fuikvangsten per vissoort voor de hele periode voor Schipdonk en Balgerhoeke (sampling effort niet in rekening gebracht)")
```

```{r visbarplotabsoluutfuikdag, fig.cap ="Verdeling van de gemiddelde vangsten per fuikdag en per vissoort in Balgerhoeke, Schipdonk sifon en Schipdonk sluis per maand (rest = overige vissoorten die elk minder dan 5% van de vangsten uitmaken)."}
domvis<-f.dominant.species(vis.fuik,0.05,type="cpue")
ggplot(domvis, aes(fill=soort, y=CPUE, x=maand)) + geom_bar(position="stack", stat="identity") + facet_wrap(~plaats) + ylab("Gemiddeld aantal (per fuikdag)")  + theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
```

```{r visbarplotabsoluutfuik, fig.cap ="Verdeling van de totale fuikvangsten per vissoort in Balgerhoeke, Schipdonk sifon en Schipdonk sluis per maand (rest = overige vissoorten die elk minder dan 5% van de vangsten uitmaken)."}
domvis<-f.dominant.species(vis.fuik,0.05,type="aantal")
ggplot(domvis, aes(fill=soort, y=Taxon.aantal, x=maand)) + geom_bar(position="stack", stat="identity") + facet_wrap(~plaats) + ylab("Totale fuikvangsten")  + theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
```

```{r}
vis.mat<-f.transformatie(vis.breed,"4root")
vis.dist=vegdist(vis.mat, method="bray",binary=FALSE,diag = TRUE)
```

```{r vis-pcoa, fig.height=10, fig.width=10, fig.cap="Principale coördinaten analyse (PCOA, CPUE, vierde-machtswortel transformatie, Bray-Curtis afstanden) met weergave van de verschillende sites (als omkaderingen) en de belangrijkste soorten (weergave als pijlen met lengte pijlen representatief voor bijdrage; p>0.05 en R²>0.4) om verschillen in gemeenschapsstructuur te verklaren."}
groups <- vis.breed$plaats
bdisp <- betadisper(vis.dist, groups)
plot(bdisp,main=NULL, sub=NULL)
abline(h = 0, v = 0, lty = 2)
efit <- vegan::envfit(bdisp, vis.mat, perm = 999)
efit<-f.select.envfit(efit, 0.4)
plot(efit, p.max = 0.05, col = "red", cex = 0.9, main=NULL, sub=NULL)
```

```{r include=FALSE, fig.height=10, fig.width=10}
f.dispersie(vis.breed,"maand")
```

```{r include=FALSE, fig.height=10, fig.width=10}
f.dispersie(vis.breed,"plaats")
```

```{r include=FALSE, fig.height=10, fig.width=10}
f.dispersie(vis.breed,"Meetplaatscode")
```

```{r include=FALSE}
adonis2(vis.dist ~ maand * plaats, data=vis.breed)
```

```{r include=FALSE}
f.pairwise.adonis(vis.dist, vis.breed$plaats)
f.pairwise.adonis(vis.dist, vis.breed$maand)
```

#### Lengteverdeling

De lengteverdeling per soort (Figuur \@ref(fig:lengteverdelingfuik)) verschilde in een aantal gevallen tussen de drie locaties (Balgerhoeke, sluizen van Schipdonk en de sifon van Schipdonk). Voor blauwband, driedoornige stekelbaars, giebel, karper, rietvoorn, snoek, en zeelt en zonnebaars waren de aantallen te klein om onderbouwde conclusies te trekken over mogelijke verschillen tussen de locaties. Baars was groter t.h.v. de Schipdonk sluis (Figuur \@ref(fig:lengteverdelingboxplot)). Blankvoorn was het grootst t.h.v. Balgerhoeke gevolgd door Schipdonk sluis en sifon. Brasem was groter t.h.v. Schipdonk sluis. Kolblei was groter t.h.v. de Schipdonk sluis dan Schipdonk sifon. Pos was het kleinst t.h.v. Schipdonk sluis. Snoekbaars was veel groter in Balgerhoeke. Zwartbekgrondel was het grootst t.h.v. Balgerhoeke gevolgd door Schipdonk sifon en sluis.

```{r lengteverdelingfuik, fig.height=10, fig.width=10, fig.cap="Lengteverdeling voor de verschillende gevangen soorten voor de hele periode voor Schipdonk en Balgerhoeke. De inverse van de CPUE werd gebruikt als gewicht voor de metingen."}
ggplot(vis.fuik, aes(x = Taxon.lengte, weight = CPUE)) + 
  geom_histogram() + xlab("Vislengte (mm)") + ylab("CPUE") +
  facet_wrap(~ soort, scales="free", labeller = label_wrap_gen(multi_line=FALSE))
```

```{r}
cmpr<-list(c('Balgerhoeke','Schipdonk sifon'),        
 c('Balgerhoeke','Schipdonk sluis'),        
 c('Schipdonk sifon','Schipdonk sluis')
 )
symnum.args <- list(cutpoints = c(0, 0.0001, 0.001, 0.01, 0.05, Inf), symbols = c("****", "***", "**", "*", "ns"))
```

```{r lengteverdelingboxplot, fig.height=10, fig.width=10, fig.cap="Boxplots die de gemiddelde lengte van de fuikvangsten voorstellen in functie van de bemonsteringslocatie. Gepaarde wilcoxon ranks sum testen met Bonferroni correctie werden gebruikt. p-waarden werden geclassificeerd als niet-significant of ns ($>$0.05), * (0.05-0.01), ** (0.01-0.001), *** (0.001-0.0001), **** (0.0001-0)."}
ggplot(data=vis.fuik%>%dplyr::filter(soort %in% c("baars","bittervoorn","blankvoorn","brasem","kolblei","paling","pos","riviergrondel","snoekbaars","zwartbekgrondel")),aes(plaats, Taxon.lengte),size = 0.5, color = "black") + geom_boxplot(linetype = 1, position = position_dodge(0.5)) + facet_wrap(~soort, scales="free_y") + ylab("Lengte (mm)") + xlab("Plaats") + theme_bw() + theme(text = element_text(size = 12, family = "serif"), axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5, family = "serif"), strip.background = element_rect(colour = "black", fill = "white"), legend.position = "bottom") + stat_compare_means(comparisons = cmpr, method = "wilcox.test", symnum.args = symnum.args, p.adjust.method = "bonferroni", label='p.adj') 
```

#### Hervangst

Enkel in Balgerhoeke werden vissen gemerkt om na te gaan hoeveel vissen zich ophopen ter hoogte van de barrière. Het aandeel hervangst steeg doorheen de tijd licht voor baars, bittervoorn, blankvoorn en brasem en leek sterk te stijgen voor paling (Figuur \@ref(fig:hervangst)). Pos, snoek en snoekbaars kenden aanvankelijk een stijging in hervangst maar deze daalde weer na een zekere periode. Giebel, kolblei en riviergrondel werden nooit opnieuw gevangen. Zwartbekgrondels werden verwijderd bij vangst omdat dit een invasieve exoot is.

```{r}
hervangst <- vis.fuik %>% 
  dplyr::select(plaats,maand,Datum,soort,gemerkt,Taxon.aantal) %>%
  group_by(plaats,maand,Datum,soort,gemerkt) %>%
  summarize(aantal=sum(Taxon.aantal)) %>% 
  ungroup() %>% 
  complete(plaats,maand,Datum,soort,gemerkt) %>% 
  replace(is.na(.), 0) %>% 
  ungroup() %>%
  group_by(plaats,maand,Datum,soort) %>% 
  mutate(totaal.aantal=sum(aantal),
         aandeel=aantal/totaal.aantal) 
```

```{r hervangst, fig.height=10, fig.width=10, fig.cap="Aandeel hervangst op totale fuikvangst per soort. Elk punt geeft de vangst van één dag weer. De grootte van de punten weerspiegelt de totale vangst per soort. Loess smoothing (span=1) werd gebruikt om een eventuele trend te visualiseren (blauwe lijn). Voor deze smoothing krijgen dagen met een grotere vangst een groter gewicht (lineaire verhouding toekenning gewicht). 95% betrouwbaarheidsintervallen van de loess smoothing zijn weergegeven als een grijze band."}
ggplot(hervangst[which(hervangst$plaats=="Balgerhoeke" & hervangst$gemerkt=="j" & is.nan(hervangst$aandeel)==FALSE),], aes(x = Datum, y = aandeel)) + 
  geom_point(aes(size=(totaal.aantal)),alpha=0.3) +
  geom_smooth(aes(weight=totaal.aantal),span=1) + 
  xlab("Datum") + ylab("Aandeel hervangst") + coord_cartesian(ylim = c(0,1)) +
  facet_wrap(~ soort, labeller = label_wrap_gen(multi_line=FALSE)) + 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
  scale_x_datetime(date_labels = "%d-%m", date_breaks = "15 days")
```

#### Reproductie

Om zicht te krijgen op het aandeel individuen met paaikenmerken, werden hervangsten buiten beschouwing gelaten (Figuur \@ref(fig:reproductie-niet-gemerkt)). Op die manier werd verhinderd dat vissen die zich ophopen ter hoogte van de barrière meerdere keren werden geteld. Van de soorten waarvan er voldoende individuen waren om betrouwbare trends te bekomen, vertoonden vooral baars (25-50%) en pos (15-45%) paaikenmerken. De trend doorheen de tijd was voor beide soorten grillig maar leek voor baars eerst te dalen en dan te stijgen terwijl deze voor pos voornamelijk licht daalde. Blankvoorn vertoonde zelden paaikenmerken (5-10%). Voor brasem, giebel en kolblei werden geen paaikenmerken vastgesteld.

Men zou verwachten dat individuen die op het punt staan om te paaien een grotere drang hebben om te migreren. Dit zou betekenen dat er een grotere kans is om paaikenmerken te observeren bij gemerkte individuen (i.e., individuen die meermaals verbleven t.h.v. de barrière). Wanneer we echter het aandeel vissen met paaikenmerken die slechts één keer werden gevangen (i.e. niet-gemerkte vissen: Figuur \@ref(fig:reproductie-niet-gemerkt)) vergelijken met het aandeel hervangsten met paaikenmerken (i.e. gemerkte vissen: Figuur \@ref(fig:reproductie-gemerkt)) dan zien we bij baars en pos een verlaagde kans op paaikenmerken gegeven dat een individu hervangst is (i.e., gemerkt is). Dit wordt ook bevestigd door een logistische gam analyse voor baars, blankvoorn, en pos waarbij voor elke soort een model is ontwikkeld met als respons of een individu al dan niet paaikenmerken vertoont en als verklarende factoren de vislengte, of een individu al dan niet hervangst is (i.e., gemerkt is) en de datum (die werd beschouwd als een smooth factor, waarbij we niet zozeer geïnteresseerd zijn in het effect van deze factor maar het effect ervan erkennen en in rekening brengen). Voor baars en pos had datum als smooth factor een significant effect wat te verwachten is gezien het sterk temporeel karakter van paaikenmerken. Voor baars en pos had de aanwezigheid van een merkteken (i.e. hervangst) een significant negatief effect op de aanwezigheid van paaikenmerken. Dit suggereert dat vissen met paaikenmerken zich niet bij de barrière ophoopten. Voor baars was ook de vislengte belangrijk waarbij langere individuen een significant grotere kans hadden om paaikenmerken te vertonen. Voor blankvoorn had geen enkele factor (datum, merkteken of vislengte) een significant effect op de kans op paaikenmerken.

```{r}
reproductie <- vis.fuik %>% 
  dplyr::select(plaats,maand,Datum,soort,reproductie,Taxon.aantal) %>%
  group_by(plaats,maand,Datum,soort,reproductie) %>%
  summarize(aantal=sum(Taxon.aantal)) %>% 
  ungroup() %>% 
  complete(plaats,maand,Datum,soort,reproductie) %>% 
  replace(is.na(.), 0) %>% 
  ungroup() %>%
  group_by(plaats,maand,Datum,soort) %>% 
  mutate(totaal.aantal=sum(aantal),
         aandeel=aantal/totaal.aantal) 
```

```{r include=FALSE, fig.height=10, fig.width=10, fig.cap="Aandeel vissen met paaikenmerken op totale fuikvangst per soort. Elk punt geeft de vangst van één dag weer. De grootte van de punten weerspiegelt de totale vangst per soort. Loess smoothing (span=1) werd gebruikt om een eventuele trend te visualiseren (blauwe lijn). Voor deze smoothing krijgen dagen met een grotere vangst een groter gewicht (lineaire verhouding toekenning gewicht). 95% betrouwbaarheidsintervallen van de loess smoothing zijn weergegeven als een grijze band."}
ggplot(reproductie[which(reproductie$plaats=="Balgerhoeke" & reproductie$reproductie=="ja" & is.nan(reproductie$aandeel)==FALSE),], aes(x = Datum, y = aandeel)) + 
  geom_point(aes(size=(totaal.aantal)),alpha=0.3) +
  geom_smooth(aes(weight=totaal.aantal),span=1) +
  xlab("Datum") + ylab("Waarde") + coord_cartesian(ylim = c(0,1)) +
  facet_wrap(~ soort, labeller = label_wrap_gen(multi_line=FALSE)) + 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
  scale_x_datetime(date_labels = "%d-%m", date_breaks = "15 days")
```

```{r}
reproductie.en.gemerkt <- vis.fuik %>% 
  dplyr::select(plaats,maand,Datum,soort,reproductie,gemerkt,Taxon.aantal) %>%
  group_by(plaats,maand,Datum,soort,reproductie,gemerkt) %>%
  summarize(aantal=sum(Taxon.aantal)) %>% 
  ungroup() %>% 
  complete(plaats,maand,Datum,soort,reproductie,gemerkt) %>% 
  replace(is.na(.), 0) %>% 
  ungroup() %>%
  group_by(plaats,maand,Datum,soort) %>% 
  mutate(totaal.aantal=sum(aantal),
         aandeel=aantal/totaal.aantal) 
```

```{r reproductie-niet-gemerkt, fig.height=10, fig.width=10, fig.cap="Aandeel niet-gemerkte vissen met paaikenmerken op totale fuikvangst per soort. Elk punt geeft de vangst van één dag weer. De grootte van de punten weerspiegelt de totale vangst per soort. Loess smoothing (span=1) werd gebruikt om een eventuele trend te visualiseren (blauwe lijn). Voor deze smoothing krijgen dagen met een grotere vangst een groter gewicht (lineaire verhouding toekenning gewicht). 95% betrouwbaarheidsintervallen van de loess smoothing zijn weergegeven als een grijze band."}
reproductie.en.ongemerkt.subset<-reproductie.en.gemerkt[which(reproductie.en.gemerkt$plaats=="Balgerhoeke" &
                                                              reproductie.en.gemerkt$reproductie=="ja" &
                                                              reproductie.en.gemerkt$gemerkt=="n" &
                                                              is.nan(reproductie.en.gemerkt$aandeel)==FALSE),]
ggplot(reproductie.en.ongemerkt.subset, aes(x = Datum, y = aandeel)) + 
  geom_point(aes(size=(totaal.aantal)),alpha=0.3) +
  geom_smooth(aes(weight=totaal.aantal),span=1) +
  xlab("Datum") + ylab("Aandeel niet-gemerkte vissen met paaikenmerken") + coord_cartesian(ylim = c(0,1)) +
  facet_wrap(~ soort, scales="free_y",labeller = label_wrap_gen(multi_line=FALSE)) + 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
  scale_x_datetime(date_labels = "%d-%m", date_breaks = "15 days")
```

```{r reproductie-gemerkt, fig.height=10, fig.width=10, fig.cap="Aandeel gemerkte vissen met paaikenmerken op totale fuikvangst per soort. Elk punt geeft de vangst van één dag weer. De grootte van de punten weerspiegelt de totale vangst per soort. Loess smoothing (span=1) werd gebruikt om een eventuele trend te visualiseren (blauwe lijn). Voor deze smoothing krijgen dagen met een grotere vangst een groter gewicht (lineaire verhouding toekenning gewicht). 95% betrouwbaarheidsintervallen van de loess smoothing zijn weergegeven als een grijze band."}
reproductie.en.gemerkt.subset<-reproductie.en.gemerkt[which(reproductie.en.gemerkt$plaats=="Balgerhoeke" &
                                                              reproductie.en.gemerkt$reproductie=="ja" &
                                                              reproductie.en.gemerkt$gemerkt=="j" &
                                                              is.nan(reproductie.en.gemerkt$aandeel)==FALSE),]
ggplot(reproductie.en.gemerkt.subset, aes(x = Datum, y = aandeel)) + 
  geom_point(aes(size=(totaal.aantal)),alpha=0.3) +
  geom_smooth(aes(weight=totaal.aantal),span=1) +
  xlab("Datum") + ylab("Aandeel gemerkte vissen met paaikenmerken") + coord_cartesian(ylim = c(0,1)) +
  facet_wrap(~ soort, scales="free_y",labeller = label_wrap_gen(multi_line=FALSE)) + 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
  scale_x_datetime(date_labels = "%d-%m", date_breaks = "15 days")
```

```{r include=FALSE}
for (i in c("baars", "blankvoorn", "pos")){
  print(i)
  vis.fuik.model<-vis.fuik[which(vis.fuik$plaats=="Balgerhoeke"&vis.fuik$soort==i),c("gemerkt","Taxon.lengte.imputatie","reproductie","Datum")]
  vis.fuik.model$gemerkt[which(vis.fuik.model$gemerkt=="j")]=1
  vis.fuik.model$gemerkt[which(vis.fuik.model$gemerkt=="n")]=0
  vis.fuik.model$gemerkt<-as.factor(vis.fuik.model$gemerkt)
  vis.fuik.model$Datum<-as.numeric(as.factor(vis.fuik.model$Datum))
  vis.fuik.model$reproductie[which(vis.fuik.model$reproductie=="ja")]=1
  vis.fuik.model$reproductie[which(vis.fuik.model$reproductie=="nee")]=0
  vis.fuik.model$reproductie<-as.factor(vis.fuik.model$reproductie)
  model1<-mgcv::gam(formula = as.formula(reproductie ~ s(Datum) + gemerkt + Taxon.lengte.imputatie), data = vis.fuik.model, family = 'binomial')
  print(summary(model1))
  model1b<-glm(formula = as.formula(reproductie ~ gemerkt + Taxon.lengte.imputatie), data = vis.fuik.model, family = 'binomial')
  print(summary(model1b))
  model2<-mgcv::gam(formula = as.formula(gemerkt ~ s(Datum) + reproductie + Taxon.lengte.imputatie), data = vis.fuik.model, family = 'binomial')
  print(summary(model2))
  #print(plot(model1))
  
  temp1 <- vis.fuik.model %>% tidyr::expand(gemerkt,Datum,full_seq(round(Taxon.lengte.imputatie),1))
  colnames(temp1)[3] <- "Taxon.lengte.imputatie"
  temp.pp<-cbind(temp1,predict(model1, newdata = temp1, "response"))
  colnames(temp.pp)[4] <- "probability"
  
  g<-ggplot(temp.pp, aes(x = Taxon.lengte.imputatie, y = probability, colour = gemerkt)) + geom_point() + theme_bw() + ylim(0,1) + ylab("Kans op paaikenmerken") + xlab("Lengte (mm)")
  print(g)
}
```

### Jonge paling

Op basis van de lengteverdeling (Figuur \@ref(fig:palinglengtegoot) en Figuur \@ref(fig:palinglengtesubstraten)) kunnen we stellen dat de gevangen jonge paling vooral elvers betrof. Er werden enkel elvers gevonden t.h.v. Balgerhoeke. Het feit dat geen elvers gevangen werden in de substraten t.h.v. Schipdonk geeft aan dat elvers niet in staat zijn om de barrière van Balgerhoeke te passeren. In de palinggoot te Balgerhoeke werden tijdens de studieperiode 59 elvers gevangen met een gemiddelde lengte van 146 mm (standaarddeviatie van 25 mm). In de substraten te Balgerhoeke werden in totaal 1268 elvers gevangen met een gemiddelde lengte van 151 mm (standaarddeviatie van 29 mm). De lengtes lijken geen trend te vertonen doorheen de tijd (Figuur \@ref(fig:palinglengtegoottijd) en Figuur \@ref(fig:palinglengtesubstratentijd)). Zowel voor de palinggoot als de substraten was er een piek in aantallen rond midden mei. Daarvoor bleven de aantallen nagenoeg constant. Aangepast spuibeheer ter hoogte van Zeebrugge werd toegepast op 18/3, 31/3, 22/4, 27/4, 2/5 en 3/5 voor 270, 255, 450, 285, 450 en 575 minuten respectievelijk.

```{r include=FALSE}
sum(vis.goot$Taxon.aantal)
mean(vis.goot$Taxon.lengte)
sd(vis.goot$Taxon.lengte)

sum(vis.substraat$Taxon.aantal)
mean(vis.substraat$Taxon.lengte,na.rm=TRUE)
sd(vis.substraat$Taxon.lengte,na.rm=TRUE)
```

#### Palinggoot

```{r palinglengtegoot, fig.cap="Lengteverdeling van elvers gevangen met de palinggoot in Balgerhoeke voor de hele studieperiode (22 maart 2023 - 25 mei 2023)."}
ggplot(vis.goot, aes(x = Taxon.lengte, weight = Taxon.aantal)) + 
  geom_histogram() + xlab("Vislengte (mm)") + ylab("Aantal")
```

```{r fig.cap="Lengteverdeling van elvers gevangen met de palinggoot in Balgerhoeke voor de drie verschillende maanden van de studieperiode (22 maart 2023 - 25 mei 2023)."}
ggplot(vis.goot, aes(x = Taxon.lengte, weight = Taxon.aantal)) + 
  geom_histogram() + xlab("Vislengte (mm)") + ylab("aantal") +
  facet_wrap(~ maand, scales="free_y",labeller = label_wrap_gen(multi_line=FALSE))
```

```{r palinglengtegoottijd, fig.cap="Lengte van elvers gevangen met de palinggoot in Balgerhoeke in functie van de tijd."}
ggplot(vis.goot, aes(x = Datum, y = Taxon.lengte)) + ylab("Vislengte (mm)") + geom_point() + geom_smooth()
```

```{r fig.cap="Aantal elvers gevangen met de palinggoot in Balgerhoeke in functie van de tijd."}
ggplot(vis.goot %>% group_by(Datum) %>% summarize(aantal=sum(Taxon.aantal)),aes(x = Datum, y = aantal)) + geom_point() + geom_smooth() + xlab("Aantal")
```

#### Substraten

```{r palinglengtesubstraten, fig.cap="Lengteverdeling van elvers gevangen met substraten in Balgerhoeke voor de hele studieperiode (22 maart 2023 - 25 mei 2023)."}
ggplot(vis.substraat, aes(x = Taxon.lengte, weight = Taxon.aantal)) + 
  geom_histogram() + xlab("Vislengte (mm)") + ylab("Aantal")
```

```{r fig.cap="Lengteverdeling van elvers gevangen met substraten in Balgerhoeke voor de drie verschillende maanden van de studieperiode (22 maart 2023 - 25 mei 2023)."}
ggplot(vis.substraat, aes(x = Taxon.lengte, weight = Taxon.aantal)) + 
  geom_histogram() + xlab("Vislengte (mm)") + ylab("Aantal") + 
  facet_wrap(~ maand, scales="free_y",labeller = label_wrap_gen(multi_line=FALSE))
```

```{r palinglengtesubstratentijd, fig.cap="Lengte van elvers gevangen met substraten in Balgerhoeke in functie van de tijd."}
ggplot(vis.substraat, aes(x = Datum, y = Taxon.lengte)) + 
  geom_point() + geom_smooth() + ylab("Vislengte (mm")
```

```{r fig.cap="Aantal elvers gevangen met de substraten in Balgerhoeke in functie van de tijd."}
ggplot(vis.substraat %>% group_by(Datum) %>% summarize(aantal=sum(Taxon.aantal)),aes(x = Datum, y = aantal)) + geom_point() + geom_smooth() + ylab("Aantal")
```
